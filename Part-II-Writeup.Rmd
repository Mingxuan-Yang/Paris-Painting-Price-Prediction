---
title: "homework"
author: "Machao Deng"
date: "2019Äê12ÔÂ14ÈÕ"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include=FALSE}
library(dplyr)
library(knitr)
library(BAS)
library(devtools)
library(tidyr)
library(ggplot2)
library(glmnet)
```

```{r}
model = bas.lm(logprice~., data=paintings_train_new, prior = 'JZS',modelprior=uniform(),method='MCMC')


model_bas <- bas.lm(logprice~.,
  data = paintings_train_new,
  prior = "g-prior",
  alpha = dim(paintings_train_new)[1],
  modelprior = uniform(),
  method = "deterministic")
ytrain=predict(model_bas,paintings_train_new,estimator="HPM")
rmse=(mean(ytrain-paintings_train_new$logprice)^2)
yhat=predict(model_bas,paintings_test_new,estimator="HPM")
interval=c(quantile(yhat,0.025)-1.96*rmse,quantile(yhat,0.975)+1.96*rmse)
fit=yhat
lwr=interval[1]
upr=interval[2]
predictions=data.frame(fit,lwr,upr)
save(predictions,file="predict-test.Rdata")
```

